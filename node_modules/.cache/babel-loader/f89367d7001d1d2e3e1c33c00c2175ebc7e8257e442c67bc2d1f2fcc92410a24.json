{"ast":null,"code":"import { isCompact } from '@polkadot/util';\nimport { l } from './logging.js';\nexport function filterEvents(txHash, _ref, allEvents, status) {\n  let {\n    block: {\n      extrinsics,\n      header\n    }\n  } = _ref;\n  // extrinsics to hashes\n  for (const [txIndex, x] of extrinsics.entries()) {\n    if (x.hash.eq(txHash)) {\n      return {\n        blockNumber: isCompact(header.number) ? header.number.unwrap() : header.number,\n        events: allEvents.filter(_ref2 => {\n          let {\n            phase\n          } = _ref2;\n          return phase.isApplyExtrinsic && phase.asApplyExtrinsic.eqn(txIndex);\n        }),\n        txIndex\n      };\n    }\n  }\n  // if we do get the block after finalized, it _should_ be there\n  // only warn on filtering with isInBlock (finalization finalizes after)\n  if (status.isInBlock) {\n    const allHashes = extrinsics.map(x => x.hash.toHex());\n    l.warn(`block ${header.hash.toHex()}: Unable to find extrinsic ${txHash.toHex()} inside ${allHashes.join(', ')}`);\n  }\n  return {};\n}","map":{"version":3,"names":["isCompact","l","filterEvents","txHash","_ref","allEvents","status","block","extrinsics","header","txIndex","x","entries","hash","eq","blockNumber","number","unwrap","events","filter","_ref2","phase","isApplyExtrinsic","asApplyExtrinsic","eqn","isInBlock","allHashes","map","toHex","warn","join"],"sources":["/home/driemworks/cryptex/ui/node_modules/@polkadot/api/util/filterEvents.js"],"sourcesContent":["import { isCompact } from '@polkadot/util';\nimport { l } from './logging.js';\nexport function filterEvents(txHash, { block: { extrinsics, header } }, allEvents, status) {\n    // extrinsics to hashes\n    for (const [txIndex, x] of extrinsics.entries()) {\n        if (x.hash.eq(txHash)) {\n            return {\n                blockNumber: isCompact(header.number) ? header.number.unwrap() : header.number,\n                events: allEvents.filter(({ phase }) => phase.isApplyExtrinsic &&\n                    phase.asApplyExtrinsic.eqn(txIndex)),\n                txIndex\n            };\n        }\n    }\n    // if we do get the block after finalized, it _should_ be there\n    // only warn on filtering with isInBlock (finalization finalizes after)\n    if (status.isInBlock) {\n        const allHashes = extrinsics.map((x) => x.hash.toHex());\n        l.warn(`block ${header.hash.toHex()}: Unable to find extrinsic ${txHash.toHex()} inside ${allHashes.join(', ')}`);\n    }\n    return {};\n}\n"],"mappings":"AAAA,SAASA,SAAS,QAAQ,gBAAgB;AAC1C,SAASC,CAAC,QAAQ,cAAc;AAChC,OAAO,SAASC,YAAYA,CAACC,MAAM,EAAAC,IAAA,EAAqCC,SAAS,EAAEC,MAAM,EAAE;EAAA,IAAtD;IAAEC,KAAK,EAAE;MAAEC,UAAU;MAAEC;IAAO;EAAE,CAAC,GAAAL,IAAA;EAClE;EACA,KAAK,MAAM,CAACM,OAAO,EAAEC,CAAC,CAAC,IAAIH,UAAU,CAACI,OAAO,EAAE,EAAE;IAC7C,IAAID,CAAC,CAACE,IAAI,CAACC,EAAE,CAACX,MAAM,CAAC,EAAE;MACnB,OAAO;QACHY,WAAW,EAAEf,SAAS,CAACS,MAAM,CAACO,MAAM,CAAC,GAAGP,MAAM,CAACO,MAAM,CAACC,MAAM,EAAE,GAAGR,MAAM,CAACO,MAAM;QAC9EE,MAAM,EAAEb,SAAS,CAACc,MAAM,CAACC,KAAA;UAAA,IAAC;YAAEC;UAAM,CAAC,GAAAD,KAAA;UAAA,OAAKC,KAAK,CAACC,gBAAgB,IAC1DD,KAAK,CAACE,gBAAgB,CAACC,GAAG,CAACd,OAAO,CAAC;QAAA,EAAC;QACxCA;MACJ,CAAC;IACL;EACJ;EACA;EACA;EACA,IAAIJ,MAAM,CAACmB,SAAS,EAAE;IAClB,MAAMC,SAAS,GAAGlB,UAAU,CAACmB,GAAG,CAAEhB,CAAC,IAAKA,CAAC,CAACE,IAAI,CAACe,KAAK,EAAE,CAAC;IACvD3B,CAAC,CAAC4B,IAAI,CAAE,SAAQpB,MAAM,CAACI,IAAI,CAACe,KAAK,EAAG,8BAA6BzB,MAAM,CAACyB,KAAK,EAAG,WAAUF,SAAS,CAACI,IAAI,CAAC,IAAI,CAAE,EAAC,CAAC;EACrH;EACA,OAAO,CAAC,CAAC;AACb"},"metadata":{},"sourceType":"module","externalDependencies":[]}